todo пропустить весь главный фрейм через фильтр с нашими брендами!, там написаны в ручную имена товарных групп, надо как-то это делать вручную!

В функции do_logic будем делать колонку в датафрейме о том наш это бренд или нет
потом из него можно фильтровать как угодно
можно уже позже пройтись по готовому фрейму и отметить те удачные поиски, которые принадлежат нашему бренду(товарной группе),
к готовому фрейму будем. чтобы не захламлять логику метода do_logic

отдельный метод будет делающий это.
в нем цикл по строкам и проверка по бренду и товарной группе, если они есть в списке то ставим флаг в колонку что из фин.классификатора


#todo добавить timestamp обратно в выдачу
#todo по фрейму идти, смотреть query, time brand, group и ответ о налчии 1/0 - делаем запрос в xml по 'nbv lfyysv '



#todo сделать фильтр по самым важным группам!
                        #группы с 95% самых искомых за каждый аггрегируемый по времени период - зависит от выбранного периода
                            #посчитать за период сумму всего поисков по всем группам - 100%
                            #получить по каждой группе товаров количество total поисков в абсолютных числах
                            #посчитать % от всего за период для каждой группы
                            #отсортировать эти % по убыванию, отрезать хвост 5%

                        #из них далее выбираем группы только стабильные(проверить стационарность ряда), выбрать те группы имеющие самые стационарные значения на самых больших промежутках времени от текущего иомента!
                        #выбрать имеющие самые длинные тренды на падение
                    #данные у меня заполняются медленно, что можно сделать?
                    #TODO нужно сделать справочники json всех городов, всех брендов, всех групп, чтобы класть в бд коды городов, брендов групп(экономияч места на диске)
                        #эти же справочники будут использоваться для value в контолах управления. по кодам в бд будем отбирать бренды/группы/города
                    # режим быстрого заполнения бд? - делаем запрос на неделю, создаем датафрейм с данными timestamp, идем по фрейму и по 5 минут отбираем!
                    #todo надо класть в бд данные без группировки а как раньше по бренду-группе


